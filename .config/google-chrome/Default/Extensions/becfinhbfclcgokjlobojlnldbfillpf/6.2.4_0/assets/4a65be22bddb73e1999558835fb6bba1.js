import{r as $}from"./0ad26b610ddcef096d4d865b8c763f01.js";import{p as Kt}from"./d773a614e054f2d9aec56b1b79e4c625.js";import{b as Gt}from"./75b49a1b196983c05948f45215119584.js";import{j as Yt}from"./247181262fddb482b5c9ae0bba2666ad.js";import{d as Jt,l as Qt,c as Qr}from"./93c5775672b5704373697ce70541c884.js";import{l as en}from"./ffddd36e5ff55eed5b60f74a6e818f25.js";import{d as rn}from"./e1b38652fd58232a8f02469e29295aab.js";import{l as et}from"./d1b65f4321c0417f893639d35dc980fe.js";var Q={},sr={},M={},tn=$,V=Kt();function nn(){var e,t,n=new V.Promise((function(n,r){e=n,t=r}));return{resolve:e,reject:t,promise:n}}M.defer=nn,M.when=V.resolve,M.resolve=V.resolve,M.all=V.all,M.props=V.props,M.reject=V.reject,M.promisify=V.promisify,M.mapSeries=V.mapSeries,M.attempt=V.attempt,M.nfcall=function(e){var t=Array.prototype.slice.call(arguments,1),n;return V.promisify(e).apply(null,t)},V.prototype.fail=V.prototype.caught,V.prototype.also=function(e){return this.then((function(t){var n=tn.extend({},t,e(t));return V.props(n)}))};var E={},an=$,F=E.types={document:"document",paragraph:"paragraph",run:"run",text:"text",tab:"tab",checkbox:"checkbox",hyperlink:"hyperlink",noteReference:"noteReference",image:"image",note:"note",commentReference:"commentReference",comment:"comment",table:"table",tableRow:"tableRow",tableCell:"tableCell",break:"break",bookmarkStart:"bookmarkStart"};function un(e,t){return t=t||{},{type:F.document,children:e,notes:t.notes||new Ae({}),comments:t.comments||[]}}function ln(e,t){var n=(t=t||{}).indent||{};return{type:F.paragraph,children:e,styleId:t.styleId||null,styleName:t.styleName||null,numbering:t.numbering||null,alignment:t.alignment||null,indent:{start:n.start||null,end:n.end||null,firstLine:n.firstLine||null,hanging:n.hanging||null}}}function sn(e,t){return t=t||{},{type:F.run,children:e,styleId:t.styleId||null,styleName:t.styleName||null,isBold:!!t.isBold,isUnderline:!!t.isUnderline,isItalic:!!t.isItalic,isStrikethrough:!!t.isStrikethrough,isAllCaps:!!t.isAllCaps,isSmallCaps:!!t.isSmallCaps,verticalAlignment:t.verticalAlignment||rt.baseline,font:t.font||null,fontSize:t.fontSize||null,highlight:t.highlight||null}}var rt={baseline:"baseline",superscript:"superscript",subscript:"subscript"};function on(e){return{type:F.text,value:e}}function cn(){return{type:F.tab}}function fn(e){return{type:F.checkbox,checked:e.checked}}function mn(e,t){return{type:F.hyperlink,children:e,href:t.href,anchor:t.anchor,targetFrame:t.targetFrame}}function pn(e){return{type:F.noteReference,noteType:e.noteType,noteId:e.noteId}}function Ae(e){this._notes=an.indexBy(e,(function(e){return tt(e.noteType,e.noteId)}))}function dn(e){return{type:F.note,noteType:e.noteType,noteId:e.noteId,body:e.body}}function hn(e){return{type:F.commentReference,commentId:e.commentId}}function vn(e){return{type:F.comment,commentId:e.commentId,body:e.body,authorName:e.authorName,authorInitials:e.authorInitials}}function tt(e,t){return e+"-"+t}function yn(e){return{type:F.image,read:function(t){return t?e.readImage(t):e.readImage().then((function(e){return Buffer.from(e)}))},readAsArrayBuffer:function(){return e.readImage()},readAsBase64String:function(){return e.readImage("base64")},readAsBuffer:function(){return e.readImage().then((function(e){return Buffer.from(e)}))},altText:e.altText,contentType:e.contentType}}function gn(e,t){return t=t||{},{type:F.table,children:e,styleId:t.styleId||null,styleName:t.styleName||null}}function wn(e,t){return t=t||{},{type:F.tableRow,children:e,isHeader:t.isHeader||!1}}function bn(e,t){return t=t||{},{type:F.tableCell,children:e,colSpan:null==t.colSpan?1:t.colSpan,rowSpan:null==t.rowSpan?1:t.rowSpan}}function or(e){return{type:F.break,breakType:e}}function Tn(e){return{type:F.bookmarkStart,name:e.name}}Ae.prototype.resolve=function(e){return this.findNoteByKey(tt(e.noteType,e.noteId))},Ae.prototype.findNoteByKey=function(e){return this._notes[e]||null},E.document=E.Document=un,E.paragraph=E.Paragraph=ln,E.run=E.Run=sn,E.text=E.Text=on,E.tab=E.Tab=cn,E.checkbox=E.Checkbox=fn,E.Hyperlink=mn,E.noteReference=E.NoteReference=pn,E.Notes=Ae,E.Note=dn,E.commentReference=hn,E.comment=vn,E.Image=yn,E.Table=gn,E.TableRow=wn,E.TableCell=bn,E.lineBreak=or("line"),E.pageBreak=or("page"),E.columnBreak=or("column"),E.BookmarkStart=Tn,E.verticalAlignment=rt;var Z={},xe=$;function J(e,t){this.value=e,this.messages=t||[]}function En(e){return new J(e,[])}function kn(e){return{type:"warning",message:e}}function xn(e){return{type:"error",message:e.message,error:e}}function cr(e){var t=[];return xe.flatten(xe.pluck(e,"messages"),!0).forEach((function(e){Rn(t,e)||t.push(e)})),t}function Rn(e,t){return void 0!==xe.find(e,Sn.bind(null,t))}function Sn(e,t){return e.type===t.type&&e.message===t.message}Z.Result=J,Z.success=En,Z.warning=kn,Z.error=xn,J.prototype.map=function(e){return new J(e(this.value),this.messages)},J.prototype.flatMap=function(e){var t=e(this.value);return new J(t.value,cr([this,t]))},J.prototype.flatMapThen=function(e){var t=this;return e(this.value).then((function(e){return new J(e.value,cr([t,e]))}))},J.combine=function(e){var t,n;return new J(xe.flatten(xe.pluck(e,"value")),cr(e))};var Ie={},In=Gt,On=Yt;function Pn(e){return On.loadAsync(e).then((function(e){function t(t){return null!==e.file(t)}function n(t,n){return e.file(t).async("uint8array").then((function(e){return"base64"===n?In.fromByteArray(e):n?new TextDecoder(n).decode(e):e;var t}))}function r(t,n){e.file(t,n)}function a(){return e.generateAsync({type:"arraybuffer"})}return{exists:t,read:n,write:r,toArrayBuffer:a}}))}function Nn(e){var t=e.lastIndexOf("/");return-1===t?{dirname:"",basename:e}:{dirname:e.substring(0,t),basename:e.substring(t+1)}}function Cn(){var e=Array.prototype.filter.call(arguments,(function(e){return e})),t=[];return e.forEach((function(e){/^\//.test(e)?t=[e]:t.push(e)})),t.join("/")}Ie.openArrayBuffer=Pn,Ie.splitPath=Nn,Ie.joinPath=Cn;var fr={},ne={},ve={},De=$;ve.Element=ye,ve.element=function(e,t,n){return new ye(e,t,n)},ve.text=function(e){return{type:"text",value:e}};var nt=ve.emptyElement={first:function(){return null},firstOrEmpty:function(){return nt},attributes:{},children:[]};function ye(e,t,n){this.type="element",this.name=e,this.attributes=t||{},this.children=n||[]}ye.prototype.first=function(e){return De.find(this.children,(function(t){return t.name===e}))},ye.prototype.firstOrEmpty=function(e){return this.first(e)||nt},ye.prototype.getElementsByTagName=function(e){var t;return at(De.filter(this.children,(function(t){return t.name===e})))},ye.prototype.text=function(){if(0===this.children.length)return"";if(1!==this.children.length||"text"!==this.children[0].type)throw new Error("Not implemented");return this.children[0].value};var Bn={getElementsByTagName:function(e){return at(De.flatten(this.map((function(t){return t.getElementsByTagName(e)}),!0)))}};function at(e){return De.extend(e,Bn)}var it={},mr={},$n=Qt,Mn=Jt;function _n(e){var t=null,n,r=new $n.DOMParser({errorHandler:function(e,n){t={level:e,message:n}}}).parseFromString(e);if(null===t)return r;throw new Error(t.level+": "+t.message)}mr.parseFromString=_n,mr.Node=Mn.Node;var tr=M,Or=$,ut=mr,lt=ve,Fn=lt.Element;it.readString=qn;var Pr=ut.Node;function qn(e,t){t=t||{};try{var n=ut.parseFromString(e,"text/xml")}catch(u){return tr.reject(u)}if("parsererror"===n.documentElement.tagName)return tr.resolve(new Error(n.documentElement.textContent));function r(e){switch(e.nodeType){case Pr.ELEMENT_NODE:return a(e);case Pr.TEXT_NODE:return lt.text(e.nodeValue)}}function a(e){var t=i(e),n=[];Or.forEach(e.childNodes,(function(e){var t=r(e);t&&n.push(t)}));var a={};return Or.forEach(e.attributes,(function(e){a[i(e)]=e.value})),new Fn(t,a,n)}function i(e){if(e.namespaceURI){var n=t[e.namespaceURI],r;return(r=n?n+":":"{"+e.namespaceURI+"}")+e.localName}return e.localName}return tr.resolve(r(n.documentElement))}var st={},Nr=$,Hn=en;function An(e,t){var n=Nr.invert(t),r={element:i,text:Dn};function a(e,t){return r[t.type](e,t)}function i(e,t){var n=e.element(u(t.name),t.attributes);t.children.forEach((function(e){a(n,e)}))}function u(e){var t=/^\{(.*)\}(.*)$/.exec(e);if(t){var r=n[t[1]];return r+(""===r?"":":")+t[2]}return e}function o(e){var n=Hn.create(u(e.name),{version:"1.0",encoding:"UTF-8",standalone:!0});return Nr.forEach(t,(function(e,t){var r="xmlns"+(""===t?"":":"+t);n.attribute(r,e)})),e.children.forEach((function(e){a(n,e)})),n.end()}return o(e)}function Dn(e,t){e.text(t.value)}st.writeString=An;var We=ve;ne.Element=We.Element,ne.element=We.element,ne.emptyElement=We.emptyElement,ne.text=We.text,ne.readString=it.readString,ne.writeString=st.writeString;var Wn=$,Xn=M,Ln=ne;fr.read=ot,fr.readXmlFromZipFile=Un;var jn={"http://schemas.openxmlformats.org/wordprocessingml/2006/main":"w","http://schemas.openxmlformats.org/officeDocument/2006/relationships":"r","http://schemas.openxmlformats.org/drawingml/2006/wordprocessingDrawing":"wp","http://schemas.openxmlformats.org/drawingml/2006/main":"a","http://schemas.openxmlformats.org/drawingml/2006/picture":"pic","http://purl.oclc.org/ooxml/wordprocessingml/main":"w","http://purl.oclc.org/ooxml/officeDocument/relationships":"r","http://purl.oclc.org/ooxml/drawingml/wordprocessingDrawing":"wp","http://purl.oclc.org/ooxml/drawingml/main":"a","http://purl.oclc.org/ooxml/drawingml/picture":"pic","http://schemas.openxmlformats.org/package/2006/content-types":"content-types","http://schemas.openxmlformats.org/package/2006/relationships":"relationships","http://schemas.openxmlformats.org/markup-compatibility/2006":"mc","urn:schemas-microsoft-com:vml":"v","urn:schemas-microsoft-com:office:word":"office-word","http://schemas.microsoft.com/office/word/2010/wordml":"wordml"};function ot(e){return Ln.readString(e,jn).then((function(e){return ct(e)[0]}))}function Un(e,t){return e.exists(t)?e.read(t,"utf-8").then(Vn).then(ot):Xn.resolve(null)}function Vn(e){return e.replace(/^\uFEFF/g,"")}function ct(e){return"element"===e.type?"mc:AlternateContent"===e.name?e.firstOrEmpty("mc:Fallback").children:(e.children=Wn.flatten(e.children.map(ct,!0)),[e]):[e]}var pr={},dr={};function Zn(e,t){return"/"===t.charAt(0)?t.substr(1):e+"/"+t}function zn(e,t){var n=e.indexOf("#");return-1!==n&&(e=e.substring(0,n)),e+"#"+t}dr.uriToZipEntryName=Zn,dr.replaceFragment=zn,pr.createBodyReader=Gn,pr._readNumberingProperties=mt;var Cr=rn,K=$,B=E,ft=Z.Result,re=Z.warning,Kn=ne,Br=dr;function Gn(e){return{readXmlElement:function(t){return new $r(e).readXmlElement(t)},readXmlElements:function(t){return new $r(e).readXmlElements(t)}}}function $r(e){var t=[],n=[],r=[],a=e.relationships,i=e.contentTypes,u=e.docxFile,o=e.files,l=e.numbering,s=e.styles;function c(e){var t;return Mr(e.map(f))}function f(e){if("element"===e.type){var t=q[e.name],n;if(t)return t(e);if(!Object.prototype.hasOwnProperty.call(Jn,e.name))return Ee([re("An unrecognised element was ignored: "+e.name)])}return ke()}function p(e){return w(e).map((function(t){return{type:"paragraphProperties",styleId:t.styleId,styleName:t.name,alignment:e.firstOrEmpty("w:jc").attributes["w:val"],numbering:mt(t.styleId,e.firstOrEmpty("w:numPr"),l),indent:m(e.firstOrEmpty("w:ind"))}}))}function m(e){return{start:e.attributes["w:start"]||e.attributes["w:left"],end:e.attributes["w:end"]||e.attributes["w:right"],firstLine:e.attributes["w:firstLine"],hanging:e.attributes["w:hanging"]}}function d(e){return b(e).map((function(t){var n=e.firstOrEmpty("w:sz").attributes["w:val"],r=/^[0-9]+$/.test(n)?parseInt(n,10)/2:null;return{type:"runProperties",styleId:t.styleId,styleName:t.name,verticalAlignment:e.firstOrEmpty("w:vertAlign").attributes["w:val"],font:e.firstOrEmpty("w:rFonts").attributes["w:ascii"],fontSize:r,isBold:y(e.first("w:b")),isUnderline:h(e.first("w:u")),isItalic:y(e.first("w:i")),isStrikethrough:y(e.first("w:strike")),isAllCaps:y(e.first("w:caps")),isSmallCaps:y(e.first("w:smallCaps")),highlight:v(e.firstOrEmpty("w:highlight").attributes["w:val"])}}))}function h(e){if(e){var t=e.attributes["w:val"];return void 0!==t&&"false"!==t&&"0"!==t&&"none"!==t}return!1}function y(e){if(e){var t=e.attributes["w:val"];return"false"!==t&&"0"!==t}return!1}function g(e){return"false"!==e&&"0"!==e}function v(e){return e&&"none"!==e?e:null}function w(e){return E(e,"w:pStyle","Paragraph",s.findParagraphStyleById)}function b(e){return E(e,"w:rStyle","Run",s.findCharacterStyleById)}function x(e){return E(e,"w:tblStyle","Table",s.findTableStyleById)}function E(e,t,n,r){var a=[],i=e.first(t),u=null,o=null;if(i&&(u=i.attributes["w:val"])){var l=r(u);l?o=l.name:a.push(Y(n,u))}return Ne({styleId:u,name:o},a)}function k(e){var r=e.attributes["w:fldCharType"];if("begin"===r)t.push({type:"begin",fldChar:e}),n=[];else if("end"===r){var a=t.pop();if("begin"===a.type&&(a=I(a)),"checkbox"===a.type)return U(B.checkbox({checked:a.checked}))}else if("separate"===r){var i,u=I(t.pop());t.push(u)}return ke()}function T(){var e=K.last(t.filter((function(e){return"hyperlink"===e.type})));return e?e.options:null}function I(e){return S(n.join(""),"begin"===e.type?e.fldChar:Kn.emptyElement)}function S(e,t){var n=/\s*HYPERLINK "(.*)"/.exec(e);if(n)return{type:"hyperlink",options:{href:n[1]}};var r=/\s*HYPERLINK\s+\\l\s+"(.*)"/.exec(e),a;if(r)return{type:"hyperlink",options:{anchor:r[1]}};if(/\s*FORMCHECKBOX\s*/.exec(e)){var i=t.firstOrEmpty("w:ffData").firstOrEmpty("w:checkBox"),u=i.first("w:checked"),o;return{type:"checkbox",checked:y(null==u?i.first("w:default"):u)}}return{type:"unknown"}}function O(e){return n.push(e.text()),ke()}function N(e){var t=e.attributes["w:font"],n=e.attributes["w:char"],r=Cr.hex(t,n);return null==r&&/^F0..$/.test(n)&&(r=Cr.hex(t,n.substring(2))),null==r?Ee([re("A w:sym element with an unsupported character was ignored: char "+n+" in font "+t)]):U(new B.Text(r.string))}function R(e){return function(t){var n=t.attributes["w:id"];return U(new B.NoteReference({noteType:e,noteId:n}))}}function F(e){return U(B.commentReference({commentId:e.attributes["w:id"]}))}function M(e){return c(e.children)}var q={"w:p":function(e){var t=e.firstOrEmpty("w:pPr"),n;if(!!t.firstOrEmpty("w:rPr").first("w:del"))return e.children.forEach((function(e){r.push(e)})),ke();var a=e.children;return r.length>0&&(a=r.concat(a),r=[]),_.map(p(t),c(a),(function(e,t){return new B.Paragraph(t,e)})).insertExtra()},"w:r":function(e){return _.map(d(e.firstOrEmpty("w:rPr")),c(e.children),(function(e,t){var n=T();return null!==n&&(t=[new B.Hyperlink(t,n)]),new B.Run(t,e)}))},"w:fldChar":k,"w:instrText":O,"w:t":function(e){return U(new B.Text(e.text()))},"w:tab":function(e){return U(new B.Tab)},"w:noBreakHyphen":function(){return U(new B.Text("‑"))},"w:softHyphen":function(e){return U(new B.Text("­"))},"w:sym":N,"w:hyperlink":function(e){var t=e.attributes["r:id"],n=e.attributes["w:anchor"];return c(e.children).map((function(r){function i(t){var n=e.attributes["w:tgtFrame"]||null;return new B.Hyperlink(r,K.extend({targetFrame:n},t))}if(t){var u=a.findTargetByRelationshipId(t);return n&&(u=Br.replaceFragment(u,n)),i({href:u})}return n?i({anchor:n}):r}))},"w:tbl":C,"w:tr":D,"w:tc":A,"w:footnoteReference":R("footnote"),"w:endnoteReference":R("endnote"),"w:commentReference":F,"w:br":function(e){var t=e.attributes["w:type"];return null==t||"textWrapping"===t?U(B.lineBreak):"page"===t?U(B.pageBreak):"column"===t?U(B.columnBreak):Ee([re("Unsupported break type: "+t)])},"w:bookmarkStart":function(e){var t=e.attributes["w:name"];return"_GoBack"===t?ke():U(new B.BookmarkStart({name:t}))},"mc:AlternateContent":function(e){return M(e.firstOrEmpty("mc:Fallback"))},"w:sdt":function(e){var t=e.firstOrEmpty("w:sdtPr").first("wordml:checkbox");if(t){var n=t.first("wordml:checked"),r=!!n&&g(n.attributes["wordml:val"]);return U(B.checkbox({checked:r}))}return c(e.firstOrEmpty("w:sdtContent").children)},"w:ins":M,"w:object":M,"w:smartTag":M,"w:drawing":M,"w:pict":function(e){return M(e).toExtra()},"v:roundrect":M,"v:shape":M,"v:textbox":M,"w:txbxContent":M,"wp:inline":V,"wp:anchor":V,"v:imagedata":Z,"v:group":M,"v:rect":M};return{readXmlElement:f,readXmlElements:c};function C(e){var t=P(e.firstOrEmpty("w:tblPr"));return c(e.children).flatMap(j).flatMap((function(e){return t.map((function(t){return B.Table(e,t)}))}))}function P(e){return x(e).map((function(e){return{styleId:e.styleId,styleName:e.name}}))}function D(e){var t,n=!!e.firstOrEmpty("w:trPr").first("w:tblHeader");return c(e.children).map((function(e){return B.TableRow(e,{isHeader:n})}))}function A(e){return c(e.children).map((function(t){var n=e.firstOrEmpty("w:tcPr"),r=n.firstOrEmpty("w:gridSpan").attributes["w:val"],a=r?parseInt(r,10):1,i=B.TableCell(t,{colSpan:a});return i._vMerge=H(n),i}))}function H(e){var t=e.first("w:vMerge");if(t){var n=t.attributes["w:val"];return"continue"===n||!n}return null}function j(e){var t,n;if(K.any(e,(function(e){return e.type!==B.types.tableRow})))return Ne(e,[re("unexpected non-row element in table, cell merging may be incorrect")]);if(K.any(e,(function(e){return K.any(e.children,(function(e){return e.type!==B.types.tableCell}))})))return Ne(e,[re("unexpected non-cell element in table row, cell merging may be incorrect")]);var r={};return e.forEach((function(e){var t=0;e.children.forEach((function(e){e._vMerge&&r[t]?r[t].rowSpan++:(r[t]=e,e._vMerge=!1),t+=e.colSpan}))})),e.forEach((function(e){e.children=e.children.filter((function(e){return!e._vMerge})),e.children.forEach((function(e){delete e._vMerge}))})),U(e)}function V(e){var t;return Mr(e.getElementsByTagName("a:graphic").getElementsByTagName("a:graphicData").getElementsByTagName("pic:pic").getElementsByTagName("pic:blipFill").getElementsByTagName("a:blip").map(W.bind(null,e)))}function W(e,t){var n=e.first("wp:docPr").attributes,r=$(n.descr)?n.title:n.descr,a=X(t);return null===a?Ee([re("Could not find image file for a:blip element")]):z(a,r)}function $(e){return null==e||/^\s*$/.test(e)}function X(e){var t=e.attributes["r:embed"],n=e.attributes["r:link"];if(t)return L(t);if(n){var r=a.findTargetByRelationshipId(n);return{path:r,read:o.read.bind(o,r)}}return null}function Z(e){var t=e.attributes["r:id"];return t?z(L(t),e.attributes["o:title"]):Ee([re("A v:imagedata element without a relationship ID was ignored")])}function L(e){var t=Br.uriToZipEntryName("word",a.findTargetByRelationshipId(e));return{path:t,read:u.read.bind(u,t)}}function z(e,t){var n=i.findContentType(e.path),r,a;return Ne(B.Image({readImage:e.read,altText:t,contentType:n}),Yn[n]?[]:re("Image of type "+n+" is unlikely to display in web browsers"))}function Y(e,t){return re(e+" style with ID "+t+" was referenced but not defined in the document")}}function mt(e,t,n){var r=t.firstOrEmpty("w:ilvl").attributes["w:val"],a=t.firstOrEmpty("w:numId").attributes["w:val"];if(void 0!==r&&void 0!==a)return n.findLevel(a,r);if(null!=e){var i=n.findLevelByParagraphStyleId(e);if(null!=i)return i}return null}var Yn={"image/png":!0,"image/gif":!0,"image/jpeg":!0,"image/svg+xml":!0,"image/tiff":!0},Jn={"office-word:wrap":!0,"v:shadow":!0,"v:shapetype":!0,"w:annotationRef":!0,"w:bookmarkEnd":!0,"w:sectPr":!0,"w:proofErr":!0,"w:lastRenderedPageBreak":!0,"w:commentRangeStart":!0,"w:commentRangeEnd":!0,"w:del":!0,"w:footnoteRef":!0,"w:endnoteRef":!0,"w:pPr":!0,"w:rPr":!0,"w:tblPr":!0,"w:tblGrid":!0,"w:trPr":!0,"w:tcPr":!0};function Ee(e){return new _(null,null,e)}function ke(){return new _(null)}function U(e){return new _(e)}function Ne(e,t){return new _(e,null,t)}function _(e,t,n){this.value=e||[],this.extra=t||[],this._result=new ft({element:this.value,extra:t},n),this.messages=this._result.messages}function Mr(e){var t=ft.combine(K.pluck(e,"_result"));return new _(K.flatten(K.pluck(t.value,"element")),K.filter(K.flatten(K.pluck(t.value,"extra")),Qn),t.messages)}function Xe(e,t){return K.flatten([e,t])}function Qn(e){return e}_.prototype.toExtra=function(){return new _(null,Xe(this.extra,this.value),this.messages)},_.prototype.insertExtra=function(){var e=this.extra;return e&&e.length?new _(Xe(this.value,e),null,this.messages):this},_.prototype.map=function(e){var t=this._result.map((function(t){return e(t.element)}));return new _(t.value,this.extra,t.messages)},_.prototype.flatMap=function(e){var t=this._result.flatMap((function(t){return e(t.element)._result}));return new _(t.value.element,Xe(this.extra,t.value.extra),t.messages)},_.map=function(e,t,n){return new _(n(e.value,t.value),Xe(e.extra,t.extra),e.messages.concat(t.messages))};var pt={};pt.DocumentXmlReader=ta;var ea=E,ra=Z.Result;function ta(e){var t=e.bodyReader;function n(n){var r=n.first("w:body");if(null==r)throw new Error("Could not find the body element: are you sure this is a docx file?");var a=t.readXmlElements(r.children).map((function(t){return new ea.Document(t,{notes:e.notes,comments:e.comments})}));return new ra(a.value,a.messages)}return{convertXmlToDocument:n}}var Le={};function na(e){var t=[];return e.children.forEach((function(e){if("relationships:Relationship"===e.name){var n={relationshipId:e.attributes.Id,target:e.attributes.Target,type:e.attributes.Type};t.push(n)}})),new hr(t)}function hr(e){var t={};e.forEach((function(e){t[e.relationshipId]=e.target}));var n={};return e.forEach((function(e){n[e.type]||(n[e.type]=[]),n[e.type].push(e.target)})),{findTargetByRelationshipId:function(e){return t[e]},findTargetsByType:function(e){return n[e]||[]}}}Le.readRelationships=na,Le.defaultValue=new hr([]),Le.Relationships=hr;var vr={};vr.readContentTypesFromXml=ia;var aa={png:"png",gif:"gif",jpeg:"jpeg",jpg:"jpeg",tif:"tiff",tiff:"tiff",bmp:"bmp"};function ia(e){var t={},n={};return e.children.forEach((function(e){if("content-types:Default"===e.name&&(t[e.attributes.Extension]=e.attributes.ContentType),"content-types:Override"===e.name){var r=e.attributes.PartName;"/"===r.charAt(0)&&(r=r.substring(1)),n[r]=e.attributes.ContentType}})),dt(n,t)}function dt(e,t){return{findContentType:function(n){var r=e[n];if(r)return r;var a=n.split("."),i=a[a.length-1];if(t.hasOwnProperty(i))return t[i];var u=aa[i.toLowerCase()];return u?"image/"+u:null}}}vr.defaultContentTypes=dt({},{});var je={},Ce=$;function yr(e,t,n){var r=Ce.flatten(Ce.values(t).map((function(e){return Ce.values(e.levels)}))),a=Ce.indexBy(r.filter((function(e){return null!=e.paragraphStyleId})),"paragraphStyleId");function i(r,a){var u=e[r];if(u){var o=t[u.abstractNumId],l;return o?null==o.numStyleLink?t[u.abstractNumId].levels[a]:i(n.findNumberingStyleById(o.numStyleLink).numId,a):null}return null}function u(e){return a[e]||null}return{findLevel:i,findLevelByParagraphStyleId:u}}function ua(e,t){if(!t||!t.styles)throw new Error("styles is missing");var n=la(e),r;return new yr(oa(e),n,t.styles)}function la(e){var t={};return e.getElementsByTagName("w:abstractNum").forEach((function(e){var n=e.attributes["w:abstractNumId"];t[n]=sa(e)})),t}function sa(e){var t={};e.getElementsByTagName("w:lvl").forEach((function(e){var n=e.attributes["w:ilvl"],r=e.firstOrEmpty("w:numFmt").attributes["w:val"],a=e.firstOrEmpty("w:pStyle").attributes["w:val"];t[n]={isOrdered:"bullet"!==r,level:n,paragraphStyleId:a}}));var n=e.firstOrEmpty("w:numStyleLink").attributes["w:val"];return{levels:t,numStyleLink:n}}function oa(e){var t={};return e.getElementsByTagName("w:num").forEach((function(e){var n=e.attributes["w:numId"],r=e.first("w:abstractNumId").attributes["w:val"];t[n]={abstractNumId:r}})),t}je.readNumberingXml=ua,je.Numbering=yr,je.defaultNumbering=new yr({},{});var Ue={};function Re(e,t,n,r){return{findParagraphStyleById:function(t){return e[t]},findCharacterStyleById:function(e){return t[e]},findTableStyleById:function(e){return n[e]},findNumberingStyleById:function(e){return r[e]}}}function ca(e){var t={},n={},r={},a={},i={paragraph:t,character:n,table:r};return e.getElementsByTagName("w:style").forEach((function(e){var t=fa(e);if("numbering"===t.type)a[t.styleId]=pa(e);else{var n=i[t.type];n&&(n[t.styleId]=t)}})),new Re(t,n,r,a)}function fa(e){var t,n,r;return{type:e.attributes["w:type"],styleId:e.attributes["w:styleId"],name:ma(e)}}function ma(e){var t=e.first("w:name");return t?t.attributes["w:val"]:null}function pa(e){var t;return{numId:e.firstOrEmpty("w:pPr").firstOrEmpty("w:numPr").firstOrEmpty("w:numId").attributes["w:val"]}}Ue.readStylesXml=ca,Ue.Styles=Re,Ue.defaultStyles=new Re({},{}),Re.EMPTY=new Re({},{},{},{});var gr={},da=E,ha=Z.Result;function ht(e,t){function n(t){return ha.combine(t.getElementsByTagName("w:"+e).filter(r).map(a))}function r(e){var t=e.attributes["w:type"];return"continuationSeparator"!==t&&"separator"!==t}function a(n){var r=n.attributes["w:id"];return t.readXmlElements(n.children).map((function(t){return da.Note({noteType:e,noteId:r,body:t})}))}return n}gr.createFootnotesReader=ht.bind(Qr,"footnote"),gr.createEndnotesReader=ht.bind(Qr,"endnote");var vt={},va=E,ya=Z.Result;function ga(e){function t(e){return ya.combine(e.getElementsByTagName("w:comment").map(n))}function n(t){var n=t.attributes["w:id"];function r(e){return(t.attributes[e]||"").trim()||null}return e.readXmlElements(t.children).map((function(e){return va.comment({commentId:n,body:e,authorName:r("w:author"),authorInitials:r("w:initials")})}))}return t}vt.createCommentsReader=ga;var yt={},wa=M;function ba(){function e(e){return wa.reject(new Error("could not open external image: '"+e+"'\ncannot open linked files from a web browser"))}return{read:e}}yt.Files=ba,sr.read=Sa,sr._findPartPaths=wt;var Ta=M,Ea=E,nr=Z.Result,Fe=Ie,gt=fr.readXmlFromZipFile,ka=pr.createBodyReader,xa=pt.DocumentXmlReader,he=Le,_r=vr,Fr=je,qr=Ue,Hr=gr,Ra=vt,Ar=yt.Files;function Sa(e,t){return t=t||{},Ta.props({contentTypes:Oa(e),partPaths:wt(e),docxFile:e,files:t.path?Ar.relativeToFile(t.path):new Ar(null)}).also((function(t){return{styles:Na(e,t.partPaths.styles)}})).also((function(t){return{numbering:Pa(e,t.partPaths.numbering,t.styles)}})).also((function(e){return{footnotes:Be(e.partPaths.footnotes,e,(function(e,t){return t?Hr.createFootnotesReader(e)(t):new nr([])})),endnotes:Be(e.partPaths.endnotes,e,(function(e,t){return t?Hr.createEndnotesReader(e)(t):new nr([])})),comments:Be(e.partPaths.comments,e,(function(e,t){return t?Ra.createCommentsReader(e)(t):new nr([])}))}})).also((function(e){return{notes:e.footnotes.flatMap((function(t){return e.endnotes.map((function(e){return new Ea.Notes(t.concat(e))}))}))}})).then((function(e){return Be(e.partPaths.mainDocument,e,(function(t,n){return e.notes.flatMap((function(r){return e.comments.flatMap((function(e){var a;return new xa({bodyReader:t,notes:r,comments:e}).convertXmlToDocument(n)}))}))}))}))}function wt(e){return Ca(e).then((function(t){var n=Dr({docxFile:e,relationships:t,relationshipType:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",basePath:"",fallbackPath:"word/document.xml"});if(!e.exists(n))throw new Error("Could not find main document part. Are you sure this is a valid .docx file?");return ge({filename:bt(n),readElement:he.readRelationships,defaultValue:he.defaultValue})(e).then((function(t){function r(r){return Dr({docxFile:e,relationships:t,relationshipType:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/"+r,basePath:Fe.splitPath(n).dirname,fallbackPath:"word/"+r+".xml"})}return{mainDocument:n,comments:r("comments"),endnotes:r("endnotes"),footnotes:r("footnotes"),numbering:r("numbering"),styles:r("styles")}}))}))}function Dr(e){var t=e.docxFile,n=e.relationships,r=e.relationshipType,a=e.basePath,i=e.fallbackPath,u,o,l=n.findTargetsByType(r).map((function(e){return Ia(Fe.joinPath(a,e),"/")})).filter((function(e){return t.exists(e)}));return 0===l.length?i:l[0]}function Ia(e,t){return e.substring(0,t.length)===t?e.substring(t.length):e}function ge(e){return function(t){return gt(t,e.filename).then((function(t){return t?e.readElement(t):e.defaultValue}))}}function Be(e,t,n){var r;return ge({filename:bt(e),readElement:he.readRelationships,defaultValue:he.defaultValue})(t.docxFile).then((function(r){var a=new ka({relationships:r,contentTypes:t.contentTypes,docxFile:t.docxFile,numbering:t.numbering,styles:t.styles,files:t.files});return gt(t.docxFile,e).then((function(e){return n(a,e)}))}))}function bt(e){var t=Fe.splitPath(e);return Fe.joinPath(t.dirname,"_rels",t.basename+".rels")}var Oa=ge({filename:"[Content_Types].xml",readElement:_r.readContentTypesFromXml,defaultValue:_r.defaultContentTypes});function Pa(e,t,n){return ge({filename:t,readElement:function(e){return Fr.readNumberingXml(e,{styles:n})},defaultValue:Fr.defaultNumbering})(e)}function Na(e,t){return ge({filename:t,readElement:qr.readStylesXml,defaultValue:qr.defaultStyles})(e)}var Ca=ge({filename:"_rels/.rels",readElement:he.readRelationships,defaultValue:he.defaultValue}),wr={},Ba=$,$a=M,Se=ne;wr.writeStyleMap=_a,wr.readStyleMap=Ha;var Ma="http://schemas.zwobble.org/mammoth/style-map",qe="mammoth/style-map",Tt="/"+qe;function _a(e,t){return e.write(qe,t),Fa(e).then((function(){return qa(e)}))}function Fa(e){var t="word/_rels/document.xml.rels",n="http://schemas.openxmlformats.org/package/2006/relationships",r="{"+n+"}Relationship";return e.read(t,"utf8").then(Se.readString).then((function(a){var i;Et(a.children,r,"Id",{Id:"rMammothStyleMap",Type:Ma,Target:Tt});var u={"":n};return e.write(t,Se.writeString(a,u))}))}function qa(e){var t="[Content_Types].xml",n="http://schemas.openxmlformats.org/package/2006/content-types",r="{"+n+"}Override";return e.read(t,"utf8").then(Se.readString).then((function(a){var i;Et(a.children,r,"PartName",{PartName:Tt,ContentType:"text/prs.mammoth.style-map"});var u={"":n};return e.write(t,Se.writeString(a,u))}))}function Et(e,t,n,r){var a=Ba.find(e,(function(e){return e.name===t&&e.attributes[n]===r[n]}));a?a.attributes=r:e.push(Se.element(t,r))}function Ha(e){return e.exists(qe)?e.read(qe,"utf8"):$a.resolve(null)}var br={},se={},te={},ae={},Wr,ar,Xr,Lr,jr;function kt(){if(Wr)return ae;Wr=1;var e=Ze();function t(t,n,a){return r(e.element(t,n,{fresh:!1}),a)}function n(t,n,a){var i;return r(e.element(t,n,{fresh:!0}),a)}function r(e,t){return{type:"element",tag:e,children:t||[]}}function a(e){return{type:"text",value:e}}var i={type:"forceWrite"};ae.freshElement=n,ae.nonFreshElement=t,ae.elementWithTag=r,ae.text=a,ae.forceWrite=i;var u={br:!0,hr:!0,img:!0,input:!0};function o(e){return 0===e.children.length&&u[e.tag.tagName]}return ae.isVoidElement=o,ae}function Aa(){if(Xr)return ar;Xr=1;var e=$,t=kt();function n(e){return r(s(e))}function r(e){var t=[];return e.map(a).forEach((function(e){l(t,e)})),t}function a(e){return i[e.type](e)}var i={element:u,text:o,forceWrite:o};function u(e){return t.elementWithTag(e.tag,r(e.children))}function o(e){return e}function l(e,n){var r=e[e.length-1];"element"===n.type&&!n.tag.fresh&&r&&"element"===r.type&&n.tag.matchesElement(r.tag)?(n.tag.separator&&l(r.children,t.text(n.tag.separator)),n.children.forEach((function(e){l(r.children,e)}))):e.push(n)}function s(e){return c(e,(function(e){return f[e.type](e)}))}function c(t,n){return e.flatten(e.map(t,n),!0)}var f={element:m,text:d,forceWrite:p};function p(e){return[e]}function m(e){var n=s(e.children);return 0!==n.length||t.isVoidElement(e)?[t.elementWithTag(e.tag,n)]:[]}function d(e){return 0===e.value.length?[]:[e]}return ar=n}function Ve(){if(Lr)return te;Lr=1;var e=kt();function t(e,t){t.forEach((function(t){n(e,t)}))}function n(e,t){r[t.type](e,t)}te.freshElement=e.freshElement,te.nonFreshElement=e.nonFreshElement,te.elementWithTag=e.elementWithTag,te.text=e.text,te.forceWrite=e.forceWrite,te.simplify=Aa();var r={element:a,text:i,forceWrite:function(){}};function a(n,r){e.isVoidElement(r)?n.selfClosing(r.tag.tagName,r.tag.attributes):(n.open(r.tag.tagName,r.tag.attributes),t(n,r.children),n.close(r.tag.tagName))}function i(e,t){e.text(t.value)}return te.write=t,te}function Ze(){if(jr)return se;jr=1;var e=$,t=Ve();function n(e,t){return r([i(e,t,{fresh:!0})])}function r(t){return new a(t.map((function(t){return e.isString(t)?i(t):t})))}function a(e){this._elements=e}function i(e,t,n){return new u(e,t,n=n||{})}function u(t,n,r){var a={};e.isArray(t)?(t.forEach((function(e){a[e]=!0})),t=t[0]):a[t]=!0,this.tagName=t,this.tagNames=a,this.attributes=n||{},this.fresh=r.fresh,this.separator=r.separator}return se.topLevelElement=n,se.elements=r,se.element=i,a.prototype.wrap=function(e){for(var t=e(),n=this._elements.length-1;n>=0;n--)t=this._elements[n].wrapNodes(t);return t},u.prototype.matchesElement=function(t){return this.tagNames[t.tagName]&&e.isEqual(this.attributes||{},t.attributes||{})},u.prototype.wrap=function(e){return this.wrapNodes(e())},u.prototype.wrapNodes=function(e){return[t.elementWithTag(this,e)]},se.empty=r([]),se.ignore={wrap:function(){return[]}},se}var Tr={};!function(e){var t=$,n=M,r=Ve();function a(e){return function(a,i){return n.when(e(a)).then((function(e){var n={};return a.altText&&(n.alt=a.altText),t.extend(n,e),[r.freshElement("img",n)]}))}}e.imgElement=a,e.inline=e.imgElement,e.dataUri=a((function(e){return e.readAsBase64String().then((function(t){return{src:"data:"+e.contentType+";base64,"+t}}))}))}(Tr);var xt={},Rt={},St=$;function Da(e){return(e=e||{}).prettyPrint?Wa():It()}Rt.writer=Da;var $e={div:!0,p:!0,ul:!0,li:!0};function Wa(){var e=0,t="  ",n=[],r=!0,a=!1,i=It();function u(t,a){$e[t]&&p(),n.push(t),i.open(t,a),$e[t]&&e++,r=!1}function o(t){$e[t]&&(e--,p()),n.pop(),i.close(t)}function l(e){f();var t=m()?e:e.replace("\n","\n  ");i.text(t)}function s(e,t){p(),i.selfClosing(e,t)}function c(){return 0===n.length||$e[n[n.length-1]]}function f(){a||(p(),a=!0)}function p(){if(a=!1,!r&&c()&&!m()){i._append("\n");for(var n=0;n<e;n++)i._append(t)}}function m(){return St.some(n,(function(e){return"pre"===e}))}return{asString:i.asString,open:u,close:o,text:l,selfClosing:s}}function It(){var e=[];function t(t,n){var r=a(n);e.push("<"+t+r+">")}function n(t){e.push("</"+t+">")}function r(t,n){var r=a(n);e.push("<"+t+r+" />")}function a(e){return St.map(e,(function(e,t){return" "+t+'="'+La(e)+'"'})).join("")}function i(t){e.push(Xa(t))}function u(t){e.push(t)}function o(){return e.join("")}return{asString:o,open:t,close:n,text:i,selfClosing:r,_append:u}}function Xa(e){return e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}function La(e){return e.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}var Ot={},ja=$;function Ur(e){return He(e,e)}function He(e,t){return function(){return{start:e,end:t}}}function Ua(e){var t=e.href||"";return t?{start:"[",end:"]("+t+")",anchorPosition:"before"}:{}}function Va(e){var t=e.src||"",n=e.alt||"";return t||n?{start:"!["+n+"]("+t+")"}:{}}function Vr(e){return function(t,n){return{start:n?"\n":"",end:n?"":"\n",list:{isOrdered:e.isOrdered,indent:n?n.indent+1:0,count:0}}}}function Za(e,t,n){(t=t||{indent:0,isOrdered:!1,count:0}).count++,n.hasClosed=!1;var r=t.isOrdered?t.count+".":"-",a;return{start:Nt("\t",t.indent)+r+" ",end:function(){if(!n.hasClosed)return n.hasClosed=!0,"\n"}}}var Pt={p:He("","\n\n"),br:He("","  \n"),ul:Vr({isOrdered:!1}),ol:Vr({isOrdered:!0}),li:Za,strong:Ur("__"),em:Ur("*"),a:Ua,img:Va};function Nt(e,t){return new Array(t+1).join(e)}function za(){var e=[],t=[],n=null,r={};function a(a,u){u=u||{};var o,l=(Pt[a]||function(){return{}})(u,n,r);t.push({end:l.end,list:n}),l.list&&(n=l.list);var s="before"===l.anchorPosition;s&&i(u),e.push(l.start||""),s||i(u)}function i(t){t.id&&e.push('<a id="'+t.id+'"></a>')}function u(r){var a=t.pop();n=a.list;var i=ja.isFunction(a.end)?a.end():a.end;e.push(i||"")}function o(e,t){a(e,t),u()}function l(t){e.push(Ka(t))}function s(){return e.join("")}return{asString:s,open:a,close:u,text:l,selfClosing:o}}function Ka(e){return e.replace(/\\/g,"\\\\").replace(/([\`\*_\{\}\[\]\(\)\#\+\-\.\!])/g,"\\$1")}!function(){for(var e=1;e<=6;e++)Pt["h"+e]=He(Nt("#",e)+" ","\n\n")}(),Ot.writer=za;var Ga=Rt,Ya=Ot;function Ja(e){return"markdown"===(e=e||{}).outputFormat?Ya.writer():Ga.writer(e)}xt.writer=Ja;var ie=$,Zr=M,Me=E,z=Ze(),lr=Z,Qa=Tr,x=Ve(),ei=xt;function ri(e){return{convertToHtml:function(t){var n=ie.indexBy(t.type===Me.types.document?t.comments:[],"commentId"),r;return new ti(e,n).convertToHtml(t)}}}function ti(e,t){var n=1,r=[],a=[],i=void 0===(e=ie.extend({ignoreEmptyParagraphs:!0},e)).idPrefix?"":e.idPrefix,u=e.ignoreEmptyParagraphs,o=z.topLevelElement("p"),l=e.styleMap||[];function s(t){var n=[],r=f(t,n,{}),a=[];Ct(r,(function(e){"deferred"===e.type&&a.push(e)}));var i={};return Zr.mapSeries(a,(function(e){return e.value().then((function(t){i[e.id]=t}))})).then((function(){function t(e){return ir(e,(function(e){return"deferred"===e.type?i[e.id]:e.children?[ie.extend({},e,{children:t(e.children)})]:[e]}))}var a=ei.writer({prettyPrint:e.prettyPrint,outputFormat:e.outputFormat});return x.write(a,x.simplify(t(r))),new lr.Result(a.asString(),n)}))}function c(e,t,n){return ir(e,(function(e){return f(e,t,n)}))}function f(e,t,n){if(!n)throw new Error("options not set");var r=q[e.type];return r?r(e,t,n):[]}function p(e,t,n){return m(e,t).wrap((function(){var r=c(e.children,t,n);return u?r:[x.forceWrite].concat(r)}))}function m(e,t){var n=g(e);return n?n.to:(e.styleId&&t.push(zr("paragraph",e)),o)}function d(e,t,n){var r=function(){return c(e.children,t,n)},a=[];if(null!==e.highlight){var i=y({type:"highlight",color:e.highlight});i&&a.push(i)}e.isSmallCaps&&a.push(h("smallCaps")),e.isAllCaps&&a.push(h("allCaps")),e.isStrikethrough&&a.push(h("strikethrough","s")),e.isUnderline&&a.push(h("underline")),e.verticalAlignment===Me.verticalAlignment.subscript&&a.push(z.element("sub",{},{fresh:!1})),e.verticalAlignment===Me.verticalAlignment.superscript&&a.push(z.element("sup",{},{fresh:!1})),e.isItalic&&a.push(h("italic","em")),e.isBold&&a.push(h("bold","strong"));var u=z.empty,o=g(e);return o?u=o.to:e.styleId&&t.push(zr("run",e)),a.push(u),a.forEach((function(e){r=e.wrap.bind(e,r)})),r()}function h(e,t){var n;return y({type:e})||(t?z.element(t,{},{fresh:!1}):z.empty)}function y(e,t){var n=g(e);return n?n.to:t}function g(e){for(var t=0;t<l.length;t++)if(l[t].from.matches(e))return l[t]}function v(e){return function(t,n){return Zr.attempt((function(){return e(t,n)})).caught((function(e){return n.push(lr.error(e)),[]}))}}function w(e){return E(e.noteType,e.noteId)}function b(e){return k(e.noteType,e.noteId)}function E(e,t){return T(e+"-"+t)}function k(e,t){return T(e+"-ref-"+t)}function T(e){return i+e}var I=z.elements([z.element("table",{},{fresh:!0})]);function S(e,t,n){return y(e,I).wrap((function(){return O(e,t,n)}))}function O(e,t,n){var r=ie.findIndex(e.children,(function(e){return!e.type===Me.types.tableRow||!e.isHeader})),a;if(-1===r&&(r=e.children.length),0===r)a=c(e.children,t,ie.extend({},n,{isTableHeader:!1}));else{var i=c(e.children.slice(0,r),t,ie.extend({},n,{isTableHeader:!0})),u=c(e.children.slice(r),t,ie.extend({},n,{isTableHeader:!1}));a=[x.freshElement("thead",{},i),x.freshElement("tbody",{},u)]}return[x.forceWrite].concat(a)}function B(e,t,n){var r=c(e.children,t,n);return[x.freshElement("tr",{},[x.forceWrite].concat(r))]}function N(e,t,n){var r=n.isTableHeader?"th":"td",a=c(e.children,t,n),i={};return 1!==e.colSpan&&(i.colspan=e.colSpan.toString()),1!==e.rowSpan&&(i.rowspan=e.rowSpan.toString()),[x.freshElement(r,i,[x.forceWrite].concat(a))]}function R(e,n,r){return y(e,z.ignore).wrap((function(){var n=t[e.commentId],r=a.length+1,i="["+ii(n)+r+"]";return a.push({label:i,comment:n}),[x.freshElement("a",{href:"#"+E("comment",e.commentId),id:k("comment",e.commentId)},[x.text(i)])]}))}function _(e,t,n){var r=e.label,a=e.comment,i=c(a.body,t,n).concat([x.nonFreshElement("p",{},[x.text(" "),x.freshElement("a",{href:"#"+k("comment",a.commentId)},[x.text("↑")])])]);return[x.freshElement("dt",{id:E("comment",a.commentId)},[x.text("Comment "+r)]),x.freshElement("dd",{},i)]}function F(e,t,n){return M(e).wrap((function(){return[]}))}function M(e){var t=g(e);return t?t.to:"line"===e.breakType?z.topLevelElement("br"):z.empty}var q={document:function(e,t,n){var i=c(e.children,t,n),u,o=c(r.map((function(t){return e.notes.resolve(t)})),t,n);return i.concat([x.freshElement("ol",{},o),x.freshElement("dl",{},ir(a,(function(e){return _(e,t,n)})))])},paragraph:p,run:d,text:function(e,t,n){return[x.text(e.value)]},tab:function(e,t,n){return[x.text("\t")]},hyperlink:function(e,t,n){var r,a={href:e.anchor?"#"+T(e.anchor):e.href};null!=e.targetFrame&&(a.target=e.targetFrame);var i=c(e.children,t,n);return[x.nonFreshElement("a",a,i)]},checkbox:function(e){var t={type:"checkbox"};return e.checked&&(t.checked="checked"),[x.freshElement("input",t)]},bookmarkStart:function(e,t,n){var r;return[x.freshElement("a",{id:T(e.name)},[x.forceWrite])]},noteReference:function(e,t,a){r.push(e);var i=x.freshElement("a",{href:"#"+w(e),id:b(e)},[x.text("["+n+++"]")]);return[x.freshElement("sup",{},[i])]},note:function(e,t,n){var r=c(e.body,t,n),a=x.elementWithTag(z.element("p",{},{fresh:!1}),[x.text(" "),x.freshElement("a",{href:"#"+b(e)},[x.text("↑")])]),i=r.concat([a]);return x.freshElement("li",{id:w(e)},i)},commentReference:R,comment:_,image:ai(v(e.convertImage||Qa.dataUri)),table:S,tableRow:B,tableCell:N,break:F};return{convertToHtml:s}}br.DocumentConverter=ri;var ni=1;function ai(e){return function(t,n,r){return[{type:"deferred",id:ni++,value:function(){return e(t,n,r)}}]}}function zr(e,t){return lr.warning("Unrecognised "+e+" style: '"+t.styleName+"' (Style ID: "+t.styleId+")")}function ir(e,t){return ie.flatten(e.map(t),!0)}function Ct(e,t){e.forEach((function(e){t(e),e.children&&Ct(e.children,t)}))}var ii=br.commentAuthorLabel=function(e){return e.authorInitials||""},Bt={},ui=E;function $t(e){if("text"===e.type)return e.value;if(e.type===ui.types.tab)return"\t";var t="paragraph"===e.type?"\n\n":"";return(e.children||[]).map($t).join("")+t}Bt.convertElementToRawText=$t;var ze={},q={};function li(e){return new Y("paragraph",e)}function si(e){return new Y("run",e)}function oi(e){return new Y("table",e)}function ci(e){return new Mt(e)}function Y(e,t){t=t||{},this._elementType=e,this._styleId=t.styleId,this._styleName=t.styleName,t.list&&(this._listIndex=t.list.levelIndex,this._listIsOrdered=t.list.isOrdered)}function Mt(e){e=e||{},this._color=e.color}function Ke(e){e=e||{},this._breakType=e.breakType}function fi(e,t,n){return e.numbering&&e.numbering.level==t&&e.numbering.isOrdered==n}function mi(e){return{operator:di,operand:e}}function pi(e){return{operator:hi,operand:e}}function di(e,t){return e.toUpperCase()===t.toUpperCase()}function hi(e,t){return 0===t.toUpperCase().indexOf(e.toUpperCase())}q.paragraph=li,q.run=si,q.table=oi,q.bold=new Y("bold"),q.italic=new Y("italic"),q.underline=new Y("underline"),q.strikethrough=new Y("strikethrough"),q.allCaps=new Y("allCaps"),q.smallCaps=new Y("smallCaps"),q.highlight=ci,q.commentReference=new Y("commentReference"),q.lineBreak=new Ke({breakType:"line"}),q.pageBreak=new Ke({breakType:"page"}),q.columnBreak=new Ke({breakType:"column"}),q.equalTo=mi,q.startsWith=pi,Y.prototype.matches=function(e){return e.type===this._elementType&&(void 0===this._styleId||e.styleId===this._styleId)&&(void 0===this._styleName||e.styleName&&this._styleName.operator(this._styleName.operand,e.styleName))&&(void 0===this._listIndex||fi(e,this._listIndex,this._listIsOrdered))&&(void 0===this._breakType||this._breakType===e.breakType)},Mt.prototype.matches=function(e){return"highlight"===e.type&&(void 0===this._color||e.color===this._color)},Ke.prototype.matches=function(e){return"break"===e.type&&(void 0===this._breakType||e.breakType===this._breakType)};var _t={},vi=et,yi=vi.RegexTokeniser;_t.tokenise=gi;var Kr="'((?:\\\\.|[^'])*)";function gi(e){var t="(?:[a-zA-Z\\-_]|\\\\.)",n;return new yi([{name:"identifier",regex:new RegExp("("+t+"(?:"+t+"|[0-9])*)")},{name:"dot",regex:/\./},{name:"colon",regex:/:/},{name:"gt",regex:/>/},{name:"whitespace",regex:/\s+/},{name:"arrow",regex:/=>/},{name:"equals",regex:/=/},{name:"startsWith",regex:/\^=/},{name:"open-paren",regex:/\(/},{name:"close-paren",regex:/\)/},{name:"open-square-bracket",regex:/\[/},{name:"close-square-bracket",regex:/\]/},{name:"string",regex:new RegExp(Kr+"'")},{name:"unterminated-string",regex:new RegExp(Kr)},{name:"integer",regex:/([0-9]+)/},{name:"choice",regex:/\|/},{name:"bang",regex:/(!)/}]).tokenise(e)}var wi=$,l=et,D=q,_e=Ze(),bi=_t.tokenise,ur=Z;function Ti(e){return Er(Bi,e)}function Ei(){return l.rules.sequence(l.rules.sequence.capture(Ft()),l.rules.tokenOfType("whitespace"),l.rules.tokenOfType("arrow"),l.rules.sequence.capture(l.rules.optional(l.rules.sequence(l.rules.tokenOfType("whitespace"),l.rules.sequence.capture(qt())).head())),l.rules.tokenOfType("end")).map((function(e,t){return{from:e,to:t.valueOrElse(_e.empty)}}))}function ki(e){return Er(Ft(),e)}function Ft(){var e=l.rules.sequence,t=function(e,t){return l.rules.then(l.rules.token("identifier",e),(function(){return t}))},n=t("p",D.paragraph),r=t("r",D.run),a=l.rules.firstOf("p or r or table",n,r),i=l.rules.sequence(l.rules.tokenOfType("dot"),l.rules.sequence.cut(),l.rules.sequence.capture(Ge)).map((function(e){return{styleId:e}})),u=l.rules.firstOf("style name matcher",l.rules.then(l.rules.sequence(l.rules.tokenOfType("equals"),l.rules.sequence.cut(),l.rules.sequence.capture(de)).head(),(function(e){return{styleName:D.equalTo(e)}})),l.rules.then(l.rules.sequence(l.rules.tokenOfType("startsWith"),l.rules.sequence.cut(),l.rules.sequence.capture(de)).head(),(function(e){return{styleName:D.startsWith(e)}}))),o=l.rules.sequence(l.rules.tokenOfType("open-square-bracket"),l.rules.sequence.cut(),l.rules.token("identifier","style-name"),l.rules.sequence.capture(u),l.rules.tokenOfType("close-square-bracket")).head(),s=l.rules.firstOf("list type",t("ordered-list",{isOrdered:!0}),t("unordered-list",{isOrdered:!1})),c=e(l.rules.tokenOfType("colon"),e.capture(s),e.cut(),l.rules.tokenOfType("open-paren"),e.capture(Ri),l.rules.tokenOfType("close-paren")).map((function(e,t){return{list:{isOrdered:e.isOrdered,levelIndex:t-1}}}));function f(e){var t=l.rules.firstOf.apply(l.rules.firstOf,["matcher suffix"].concat(e)),n=l.rules.zeroOrMore(t);return l.rules.then(n,(function(e){var t={};return e.forEach((function(e){wi.extend(t,e)})),t}))}var p=e(e.capture(a),e.capture(f([i,o,c]))).map((function(e,t){return e(t)})),m=e(l.rules.token("identifier","table"),e.capture(f([i,o]))).map((function(e){return D.table(e)})),d=t("b",D.bold),h=t("i",D.italic),y=t("u",D.underline),g=t("strike",D.strikethrough),v=t("all-caps",D.allCaps),w=t("small-caps",D.smallCaps),b=e(l.rules.token("identifier","highlight"),l.rules.sequence.capture(l.rules.optional(l.rules.sequence(l.rules.tokenOfType("open-square-bracket"),l.rules.sequence.cut(),l.rules.token("identifier","color"),l.rules.tokenOfType("equals"),l.rules.sequence.capture(de),l.rules.tokenOfType("close-square-bracket")).head()))).map((function(e){return D.highlight({color:e.valueOrElse(void 0)})})),x=t("comment-reference",D.commentReference),E=e(l.rules.token("identifier","br"),e.cut(),l.rules.tokenOfType("open-square-bracket"),l.rules.token("identifier","type"),l.rules.tokenOfType("equals"),e.capture(de),l.rules.tokenOfType("close-square-bracket")).map((function(e){switch(e){case"line":return D.lineBreak;case"page":return D.pageBreak;case"column":return D.columnBreak}}));return l.rules.firstOf("element type",p,m,d,h,y,g,v,w,b,x,E)}function xi(e){return Er(qt(),e)}function qt(){var e=l.rules.sequence.capture,t=l.rules.tokenOfType("whitespace"),n=l.rules.then(l.rules.optional(l.rules.sequence(l.rules.tokenOfType("colon"),l.rules.token("identifier","fresh"))),(function(e){return e.map((function(){return!0})).valueOrElse(!1)})),r=l.rules.then(l.rules.optional(l.rules.sequence(l.rules.tokenOfType("colon"),l.rules.token("identifier","separator"),l.rules.tokenOfType("open-paren"),e(de),l.rules.tokenOfType("close-paren")).head()),(function(e){return e.valueOrElse("")})),a=l.rules.oneOrMoreWithSeparator(Ge,l.rules.tokenOfType("choice")),i=l.rules.sequence(e(a),e(l.rules.zeroOrMore(Pi)),e(n),e(r)).map((function(e,t,n,r){var a={},i={};return t.forEach((function(e){e.append&&a[e.name]?a[e.name]+=" "+e.value:a[e.name]=e.value})),n&&(i.fresh=!0),r&&(i.separator=r),_e.element(e,a,i)}));return l.rules.firstOf("html path",l.rules.then(l.rules.tokenOfType("bang"),(function(){return _e.ignore})),l.rules.then(l.rules.zeroOrMoreWithSeparator(i,l.rules.sequence(t,l.rules.tokenOfType("gt"),t)),_e.elements))}ze.readHtmlPath=xi,ze.readDocumentMatcher=ki,ze.readStyle=Ti;var Ge=l.rules.then(l.rules.tokenOfType("identifier"),Ht),Ri=l.rules.tokenOfType("integer"),de=l.rules.then(l.rules.tokenOfType("string"),Ht),Si={n:"\n",r:"\r",t:"\t"};function Ht(e){return e.replace(/\\(.)/g,(function(e,t){return Si[t]||t}))}var Ii=l.rules.sequence(l.rules.tokenOfType("open-square-bracket"),l.rules.sequence.cut(),l.rules.sequence.capture(Ge),l.rules.tokenOfType("equals"),l.rules.sequence.capture(de),l.rules.tokenOfType("close-square-bracket")).map((function(e,t){return{name:e,value:t,append:!1}})),Oi=l.rules.sequence(l.rules.tokenOfType("dot"),l.rules.sequence.cut(),l.rules.sequence.capture(Ge)).map((function(e){return{name:"class",value:e,append:!0}})),Pi=l.rules.firstOf("attribute or class",Ii,Oi);function Er(e,t){var n=bi(t),r,a=l.Parser().parseTokens(e,n);return a.isSuccess()?ur.success(a.value()):new ur.Result(null,[ur.warning(Ni(t,a))])}function Ni(e,t){return"Did not understand this style mapping, so ignored it: "+e+"\n"+t.errors().map(Ci).join("\n")}function Ci(e){return"Error was at character number "+e.characterNumber()+": Expected "+e.expected+" but got "+e.actual}var Bi=Ei(),Ye={};Ye.readOptions=_i;var At=$,$i=Ye._defaultStyleMap=["p.Heading1 => h1:fresh","p.Heading2 => h2:fresh","p.Heading3 => h3:fresh","p.Heading4 => h4:fresh","p.Heading5 => h5:fresh","p.Heading6 => h6:fresh","p[style-name='Heading 1'] => h1:fresh","p[style-name='Heading 2'] => h2:fresh","p[style-name='Heading 3'] => h3:fresh","p[style-name='Heading 4'] => h4:fresh","p[style-name='Heading 5'] => h5:fresh","p[style-name='Heading 6'] => h6:fresh","p[style-name='heading 1'] => h1:fresh","p[style-name='heading 2'] => h2:fresh","p[style-name='heading 3'] => h3:fresh","p[style-name='heading 4'] => h4:fresh","p[style-name='heading 5'] => h5:fresh","p[style-name='heading 6'] => h6:fresh","r[style-name='Strong'] => strong","p[style-name='footnote text'] => p:fresh","r[style-name='footnote reference'] =>","p[style-name='endnote text'] => p:fresh","r[style-name='endnote reference'] =>","p[style-name='annotation text'] => p:fresh","r[style-name='annotation reference'] =>","p[style-name='Footnote'] => p:fresh","r[style-name='Footnote anchor'] =>","p[style-name='Endnote'] => p:fresh","r[style-name='Endnote anchor'] =>","p:unordered-list(1) => ul > li:fresh","p:unordered-list(2) => ul|ol > li > ul > li:fresh","p:unordered-list(3) => ul|ol > li > ul|ol > li > ul > li:fresh","p:unordered-list(4) => ul|ol > li > ul|ol > li > ul|ol > li > ul > li:fresh","p:unordered-list(5) => ul|ol > li > ul|ol > li > ul|ol > li > ul|ol > li > ul > li:fresh","p:ordered-list(1) => ol > li:fresh","p:ordered-list(2) => ul|ol > li > ol > li:fresh","p:ordered-list(3) => ul|ol > li > ul|ol > li > ol > li:fresh","p:ordered-list(4) => ul|ol > li > ul|ol > li > ul|ol > li > ol > li:fresh","p:ordered-list(5) => ul|ol > li > ul|ol > li > ul|ol > li > ul|ol > li > ol > li:fresh","r[style-name='Hyperlink'] =>","p[style-name='Normal'] => p:fresh"],Mi=Ye._standardOptions={transformDocument:Fi,includeDefaultStyleMap:!0,includeEmbeddedStyleMap:!0};function _i(e){return e=e||{},At.extend({},Mi,e,{customStyleMap:Gr(e.styleMap),readStyleMap:function(){var e=this.customStyleMap;return this.includeEmbeddedStyleMap&&(e=e.concat(Gr(this.embeddedStyleMap))),this.includeDefaultStyleMap&&(e=e.concat($i)),e}})}function Gr(e){return e?At.isString(e)?e.split("\n").map((function(e){return e.trim()})).filter((function(e){return""!==e&&"#"!==e.charAt(0)})):e:[]}function Fi(e){return e}var Dt={},Yr=M,qi=Ie;function Hi(e){return e.arrayBuffer?Yr.resolve(qi.openArrayBuffer(e.arrayBuffer)):Yr.reject(new Error("Could not find file in options"))}Dt.openZip=Hi;var we={},Jr=$;function Ai(e){return Wt("paragraph",e)}function Di(e){return Wt("run",e)}function Wt(e,t){return Xt((function(n){return n.type===e?t(n):n}))}function Xt(e){return function t(n){if(n.children){var r=Jr.map(n.children,t);n=Jr.extend(n,{children:r})}return e(n)}}function Wi(e,t){return Lt(e).filter((function(e){return e.type===t}))}function Lt(e){var t=[];return jt(e,(function(e){t.push(e)})),t}function jt(e,t){e.children&&e.children.forEach((function(e){jt(e,t),t(e)}))}we.paragraph=Ai,we.run=Di,we._elements=Xt,we.getDescendantsOfType=Wi,we.getDescendants=Lt;var Ut={},Xi=Ze(),Li=Ve();function ji(e){return function(t){return Li.elementWithTag(Xi.element(e),[t])}}Ut.element=ji;var Ui=$,Vt=sr,kr=wr,Vi=br.DocumentConverter,Zi=Bt.convertElementToRawText,zi=ze.readStyle,Ki=Ye.readOptions,Je=Dt,Gi=Z.Result;function Yi(e,t){return xr(e,t)}function Ji(e,t){var n=Object.create(t||{});return n.outputFormat="markdown",xr(e,n)}function xr(e,t){return t=Ki(t),Je.openZip(e).tap((function(e){return kr.readStyleMap(e).then((function(e){t.embeddedStyleMap=e}))})).then((function(n){return Vt.read(n,e).then((function(e){return e.map(t.transformDocument)})).then((function(e){return eu(e,t)}))}))}function Qi(e){return Je.openZip(e).then(kr.readStyleMap)}function eu(e,t){var n=ru(t.readStyleMap()),r=Ui.extend({},t,{styleMap:n.value}),a=new Vi(r);return e.flatMapThen((function(e){return n.flatMapThen((function(t){return a.convertToHtml(e)}))}))}function ru(e){return Gi.combine((e||[]).map(zi)).map((function(e){return e.filter((function(e){return!!e}))}))}function tu(e){return Je.openZip(e).then(Vt.read).then((function(e){return e.map(Zi)}))}function nu(e,t){return Je.openZip(e).tap((function(e){return kr.writeStyleMap(e,t)})).then((function(e){return e.toArrayBuffer()})).then((function(e){return{toArrayBuffer:function(){return e},toBuffer:function(){return Buffer.from(e)}}}))}Q.convertToHtml=Yi,Q.convertToMarkdown=Ji,Q.convert=xr,Q.extractRawText=tu,Q.images=Tr,Q.transforms=we,Q.underline=Ut,Q.embedStyleMap=nu,Q.readEmbeddedStyleMap=Qi,Q.styleMapping=function(){throw new Error("Use a raw string instead of mammoth.styleMapping e.g. \"p[style-name='Title'] => h1\" instead of mammoth.styleMapping(\"p[style-name='Title'] => h1\")")};export{Q as l};