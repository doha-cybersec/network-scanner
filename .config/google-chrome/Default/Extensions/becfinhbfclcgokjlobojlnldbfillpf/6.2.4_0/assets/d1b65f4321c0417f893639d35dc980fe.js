import{r as j}from"./0ad26b610ddcef096d4d865b8c763f01.js";import{o as B}from"./6f91a82c1b3d972807b78791ed186c86.js";var k={},z={},M={exports:{}},T=M.exports=function(r,t){this._tokens=r,this._startIndex=t||0};T.prototype.head=function(){return this._tokens[this._startIndex]},T.prototype.tail=function(r){return new T(this._tokens,this._startIndex+1)},T.prototype.toArray=function(){return this._tokens.slice(this._startIndex)},T.prototype.end=function(){return this._tokens[this._tokens.length-1]},T.prototype.to=function(r){var t=this.head().source,e=r.head()||r.end();return t.to(e.source)};var G=M.exports,H=G;z.Parser=function(r){var t;return{parseTokens:function(r,t){return r(new H(t))}}};var O={},R={failure:function(r,t){if(r.length<1)throw new Error("Failure must have errors");return new y({status:"failure",remaining:t,errors:r})},error:function(r,t){if(r.length<1)throw new Error("Failure must have errors");return new y({status:"error",remaining:t,errors:r})},success:function(r,t,e){return new y({status:"success",value:r,source:e,remaining:t,errors:[]})},cut:function(r){return new y({status:"cut",remaining:r,errors:[]})}},y=function(r){this._value=r.value,this._status=r.status,this._hasValue=void 0!==r.value,this._remaining=r.remaining,this._source=r.source,this._errors=r.errors};y.prototype.map=function(r){return this._hasValue?new y({value:r(this._value,this._source),status:this._status,remaining:this._remaining,source:this._source,errors:this._errors}):this},y.prototype.changeRemaining=function(r){return new y({value:this._value,status:this._status,remaining:r,source:this._source,errors:this._errors})},y.prototype.isSuccess=function(){return"success"===this._status||"cut"===this._status},y.prototype.isFailure=function(){return"failure"===this._status},y.prototype.isError=function(){return"error"===this._status},y.prototype.isCut=function(){return"cut"===this._status},y.prototype.value=function(){return this._value},y.prototype.remaining=function(){return this._remaining},y.prototype.source=function(){return this._source},y.prototype.errors=function(){return this._errors};var q={error:function(r){return new C(r)}},C=function(r){this.expected=r.expected,this.actual=r.actual,this._location=r.location};C.prototype.describe=function(){var r;return(this._location?this._location.describe()+":\n":"")+"Expected "+this.expected+"\nbut got "+this.actual},C.prototype.lineNumber=function(){return this._location.lineNumber()},C.prototype.characterNumber=function(){return this._location.characterNumber()};var V={fromArray:function(r){var t=0,e=function(){return t<r.length};return new S({hasNext:e,next:function(){if(e())return r[t++];throw new Error("No more elements")}})}},S=function(r){this._iterator=r};S.prototype.map=function(r){var t=this._iterator;return new S({hasNext:function(){return t.hasNext()},next:function(){return r(t.next())}})},S.prototype.filter=function(r){var t=this._iterator,e=!1,n=!1,u,i=function(){if(!e)for(e=!0,n=!1;t.hasNext()&&!n;)u=t.next(),n=r(u)};return new S({hasNext:function(){return i(),n},next:function(){var r;return i(),e=!1,u}})},S.prototype.first=function(){var r=this._iterator;return this._iterator.hasNext()?r.next():null},S.prototype.toArray=function(){for(var r=[];this._iterator.hasNext();)r.push(this._iterator.next());return r},function(r){var t=j,e=B,n=R,u=q,i=V;r.token=function(r,t){var e=void 0!==t;return function(u){var i=u.head(),o;return!i||i.name!==r||e&&i.value!==t?l(u,f({name:r,value:t})):n.success(i.value,u.tail(),i.source)}},r.tokenOfType=function(t){return r.token(t)},r.firstOf=function(r,e){return t.isArray(e)||(e=Array.prototype.slice.call(arguments,1)),function(t){return i.fromArray(e).map((function(r){return r(t)})).filter((function(r){return r.isSuccess()||r.isError()})).first()||l(t,r)}},r.then=function(r,t){return function(e){var n=r(e);return n.map||console.log(n),n.map(t)}},r.sequence=function(){var e=Array.prototype.slice.call(arguments,0),u=function(u){var i=t.foldl(e,(function(r,t){var e=r.result,i=r.hasCut;if(!e.isSuccess())return{result:e,hasCut:i};var o=t(e.remaining());if(o.isCut())return{result:e,hasCut:!0};if(o.isSuccess()){var s;s=t.isCaptured?e.value().withValue(t,o.value()):e.value();var a=o.remaining(),c=u.to(a);return{result:n.success(s,a,c),hasCut:i}}return i?{result:n.error(o.errors(),o.remaining()),hasCut:i}:{result:o,hasCut:i}}),{result:n.success(new o,u),hasCut:!1}).result,s=u.to(i.remaining());return i.map((function(t){return t.withValue(r.sequence.source,s)}))};function i(r){return r.isCaptured}return u.head=function(){var n=t.find(e,i);return r.then(u,r.sequence.extract(n))},u.map=function(t){return r.then(u,(function(r){return t.apply(this,r.toArray())}))},u};var o=function(r,t){this._values=r||{},this._valuesArray=t||[]};o.prototype.withValue=function(r,e){if(r.captureName&&r.captureName in this._values)throw new Error('Cannot add second value for capture "'+r.captureName+'"');var n=t.clone(this._values);n[r.captureName]=e;var u=this._valuesArray.concat([e]);return new o(n,u)},o.prototype.get=function(r){if(r.captureName in this._values)return this._values[r.captureName];throw new Error('No value for capture "'+r.captureName+'"')},o.prototype.toArray=function(){return this._valuesArray},r.sequence.capture=function(r,t){var e=function(){return r.apply(this,arguments)};return e.captureName=t,e.isCaptured=!0,e},r.sequence.extract=function(r){return function(t){return t.get(r)}},r.sequence.applyValues=function(r){var t=Array.prototype.slice.call(arguments,1);return function(e){var n=t.map((function(r){return e.get(r)}));return r.apply(this,n)}},r.sequence.source={captureName:"☃source☃"},r.sequence.cut=function(){return function(r){return n.cut(r)}},r.optional=function(r){return function(t){var u=r(t);return u.isSuccess()?u.map(e.some):u.isFailure()?n.success(e.none,t):u}},r.zeroOrMoreWithSeparator=function(r,t){return c(r,t,!1)},r.oneOrMoreWithSeparator=function(r,t){return c(r,t,!0)};var s=r.zeroOrMore=function(r){return function(t){for(var e=[],u;(u=r(t))&&u.isSuccess();)t=u.remaining(),e.push(u.value());return u.isError()?u:n.success(e,t)}};function a(r){return n.success(null,r)}r.oneOrMore=function(t){return r.oneOrMoreWithSeparator(t,a)};var c=function(t,e,u){return function(i){var o=t(i);if(o.isSuccess()){var a=r.sequence.capture(t,"main"),c,f=s(r.then(r.sequence(e,a),r.sequence.extract(a)))(o.remaining());return n.success([o.value()].concat(f.value()),f.remaining())}return u||o.isError()?o:n.success([],i)}};r.leftAssociative=function(t,e,u){var i;i=(i=u?[{func:u,rule:e}]:e).map((function(t){return r.then(t.rule,(function(r){return function(e,n){return t.func(e,r,n)}}))}));var o=r.firstOf.apply(null,["rules"].concat(i));return function(r){var e=r,u=t(r);if(!u.isSuccess())return u;for(var i=o(u.remaining());i.isSuccess();){var s=i.remaining(),a=e.to(i.remaining()),c=i.value();u=n.success(c(u.value(),a),s,a),i=o(u.remaining())}return i.isError()?i:u}},r.leftAssociative.firstOf=function(){return Array.prototype.slice.call(arguments,0)},r.nonConsuming=function(r){return function(t){return r(t).changeRemaining(t)}};var f=function(r){return r.value?r.name+' "'+r.value+'"':r.name};function l(r,t){var e,i=r.head();return e=i?u.error({expected:t,actual:f(i),location:i.source}):u.error({expected:t,actual:"end of tokens"}),n.failure([e],r)}}(O);var F={exports:({},function(r,t){var e;return{asString:function(){return r},range:function(e,n){return new I(r,t,e,n)}}})},I=function(r,t,e,n){this._string=r,this._description=t,this._startIndex=e,this._endIndex=n};I.prototype.to=function(r){return new I(this._string,this._description,this._startIndex,r._endIndex)},I.prototype.describe=function(){var r=this._position(),t;return(this._description?this._description+"\n":"")+"Line number: "+r.lineNumber+"\nCharacter number: "+r.characterNumber},I.prototype.lineNumber=function(){return this._position().lineNumber},I.prototype.characterNumber=function(){return this._position().characterNumber},I.prototype._position=function(){for(var r=this,t=0,e=function(){return r._string.indexOf("\n",t)},n=1;-1!==e()&&e()<this._startIndex;)t=e()+1,n+=1;var u;return{lineNumber:n,characterNumber:this._startIndex-t+1}};var W=F.exports,L=function(r,t,e){this.name=r,this.value=t,e&&(this.source=e)},P={};!function(r){var t=O,e=R;function n(r){function u(t){return new n(r.slice(0,o().indexOf(t)))}function i(t){return new n(r.slice(0,o().indexOf(t)+1))}function o(){return r.map((function(r){return r.name}))}function s(r){for(var t,n;;){if(!(t=a(r.remaining())).isSuccess())return t.isFailure()?r:t;n=r.source().to(t.source()),r=e.success(t.value()(r.value(),n),t.remaining(),n)}}function a(e){return t.firstOf("infix",r.map((function(r){return r.rule})))(e)}return{apply:s,untilExclusive:u,untilInclusive:i}}r.parser=function(r,e,i){var o={rule:f,leftAssociative:l,rightAssociative:p},s=new n(i.map(c)),a=t.firstOf(r,e);function c(r){return{name:r.name,rule:u(r.ruleBuilder.bind(null,o))}}function f(){return h(s)}function l(r){return h(s.untilExclusive(r))}function p(r){return h(s.untilInclusive(r))}function h(r){return v.bind(null,r)}function v(r,t){var e=a(t);return e.isSuccess()?r.apply(e):e}return o},r.infix=function(t,e){function n(n){return r.infix(t,(function(r){var t=e(r);return function(r){var e;return t(r).map((function(r){return function(t,e){return n(t,r,e)}}))}}))}return{name:t,ruleBuilder:e,map:n}};var u=function(r){var t;return function(e){return t||(t=r()),t(e)}}}(P);var U={},E=L,J=W;function K(r){function t(r,t){for(var u=new J(r,t),i=0,o=[];i<r.length;){var s=e(r,i,u);i=s.endIndex,o.push(s.token)}return o.push(n(r,u)),o}function e(t,e,n){for(var u=0;u<r.length;u++){var i=r[u].regex;i.lastIndex=e;var o=i.exec(t);if(o){var s=e+o[0].length;if(o.index===e&&s>e){var a=o[1],c;return{token:c=new E(r[u].name,a,n.range(e,s)),endIndex:s}}}}var s=e+1,c;return{token:c=new E("unrecognisedCharacter",t.substring(e,s),n.range(e,s)),endIndex:s}}function n(r,t){return new E("end",null,t.range(r.length,r.length))}return r=r.map((function(r){return{name:r.name,regex:new RegExp(r.regex.source,"g")}})),{tokenise:t}}U.RegexTokeniser=K,k.Parser=z.Parser,k.rules=O,k.errors=q,k.results=R,k.StringSource=W,k.Token=L,k.bottomUp=P,k.RegexTokeniser=U.RegexTokeniser,k.rule=function(r){var t;return function(e){return t||(t=r()),t(e)}};export{k as l};